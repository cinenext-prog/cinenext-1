{"version":3,"mappings":"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","names":["API_KEY_STORAGE","LIVEPEER_API_BASE","apiKeyInput","saveKeyBtn","connectBtn","clearKeyBtn","apiStatus","uploadForm","uploadNameInput","uploadFileInput","uploadDescriptionInput","uploadCategoryInput","uploadUnlockTypeInput","uploadNftAddressInput","uploadPriceInput","uploadEncryptedInput","uploadMetadataJsonInput","uploadResetBtn","uploadProgress","searchInput","refreshBtn","table","tbody","emptyState","editPanel","editForm","editIdInput","editNameInput","editMetadataJsonInput","editCancelBtn","toast","assets","safeParse","raw","fallback","showToast","text","isError","readApiKey","setApiStatus","toIsoTime","value","time","normalizeMetadata","metadata","parsed","pickPlaybackId","asset","_a","normalizeAsset","requestLivepeer","path","method","body","apiKey","headers","response","reason","toQueryString","params","query","key","output","parseAssetPage","payload","items","nextCursor","_b","hasNext","_c","listAssets","collected","page","cursor","index","unique","seen","item","id","toMetaPreview","values","setUploadProgress","clearEditForm","buildMetadataFromUploadForm","unlockType","extras","uploadByTus","file","name","tusModule","__vitePreload","tus","uploadMetadata","resolve","reject","upload","error","uploaded","total","progress","render","filtered","tr","nameTd","statusTd","playbackTd","timeTd","metadataTd","actionsTd","editBtn","deleteBtn","refreshAssets","showMessage","openEdit","target","deleteAsset","confirmText","event","action","bootstrap","cachedKey"],"ignoreList":[],"sources":["../../admin.js"],"sourcesContent":["const API_KEY_STORAGE = 'cinenext_livepeer_api_key';\nconst LIVEPEER_API_BASE = 'https://livepeer.studio/api';\n\nconst apiKeyInput = document.querySelector('#api-key');\nconst saveKeyBtn = document.querySelector('#save-key');\nconst connectBtn = document.querySelector('#connect-api');\nconst clearKeyBtn = document.querySelector('#clear-key');\nconst apiStatus = document.querySelector('#api-status');\n\nconst uploadForm = document.querySelector('#upload-form');\nconst uploadNameInput = document.querySelector('#upload-name');\nconst uploadFileInput = document.querySelector('#upload-file');\nconst uploadDescriptionInput = document.querySelector('#upload-description');\nconst uploadCategoryInput = document.querySelector('#upload-category');\nconst uploadUnlockTypeInput = document.querySelector('#upload-unlock-type');\nconst uploadNftAddressInput = document.querySelector('#upload-nft-address');\nconst uploadPriceInput = document.querySelector('#upload-price');\nconst uploadEncryptedInput = document.querySelector('#upload-encrypted');\nconst uploadMetadataJsonInput = document.querySelector('#upload-metadata-json');\nconst uploadResetBtn = document.querySelector('#upload-reset');\nconst uploadProgress = document.querySelector('#upload-progress');\n\nconst searchInput = document.querySelector('#search-input');\nconst refreshBtn = document.querySelector('#refresh-list');\nconst table = document.querySelector('#video-table');\nconst tbody = document.querySelector('#video-tbody');\nconst emptyState = document.querySelector('#empty-state');\n\nconst editPanel = document.querySelector('#edit-panel');\nconst editForm = document.querySelector('#edit-form');\nconst editIdInput = document.querySelector('#edit-id');\nconst editNameInput = document.querySelector('#edit-name');\nconst editMetadataJsonInput = document.querySelector('#edit-metadata-json');\nconst editCancelBtn = document.querySelector('#edit-cancel');\n\nconst toast = document.querySelector('#toast');\n\nlet assets = [];\n\nconst safeParse = (raw, fallback) => {\n  try {\n    return JSON.parse(raw);\n  } catch {\n    return fallback;\n  }\n};\n\nconst showToast = (text, isError = false) => {\n  toast.textContent = text;\n  toast.style.color = isError ? '#ff9d9d' : '#89d6a8';\n  window.setTimeout(() => {\n    if (toast.textContent === text) {\n      toast.textContent = '';\n    }\n  }, 2600);\n};\n\nconst readApiKey = () => apiKeyInput.value.trim();\n\nconst setApiStatus = (text, isError = false) => {\n  apiStatus.textContent = text;\n  apiStatus.style.color = isError ? '#ff9d9d' : '#97a2bb';\n};\n\nconst toIsoTime = (value) => {\n  if (!value) return '-';\n  const time = new Date(value);\n  if (Number.isNaN(time.getTime())) return '-';\n  return `${time.getFullYear()}-${String(time.getMonth() + 1).padStart(2, '0')}-${String(\n    time.getDate()\n  ).padStart(2, '0')} ${String(time.getHours()).padStart(2, '0')}:${String(time.getMinutes()).padStart(2, '0')}`;\n};\n\nconst normalizeMetadata = (metadata) => {\n  if (!metadata) return {};\n  if (typeof metadata === 'string') {\n    const parsed = safeParse(metadata, {});\n    return parsed && typeof parsed === 'object' && !Array.isArray(parsed) ? parsed : {};\n  }\n  if (typeof metadata === 'object' && !Array.isArray(metadata)) {\n    return metadata;\n  }\n  return {};\n};\n\nconst pickPlaybackId = (asset) => {\n  if (asset.playbackId) return String(asset.playbackId);\n  if (Array.isArray(asset.playbackIds) && asset.playbackIds[0]?.id) return String(asset.playbackIds[0].id);\n  if (Array.isArray(asset.playbackIds) && typeof asset.playbackIds[0] === 'string') return asset.playbackIds[0];\n  return '';\n};\n\nconst normalizeAsset = (asset) => {\n  const metadata = normalizeMetadata(asset.metadata);\n  return {\n    id: String(asset.id || ''),\n    name: String(asset.name || '未命名资源'),\n    status: String(asset.status?.phase || asset.status || 'unknown'),\n    createdAt: asset.createdAt || asset.created_at || '',\n    playbackId: pickPlaybackId(asset),\n    metadata,\n    raw: asset,\n  };\n};\n\nconst requestLivepeer = async (path, { method = 'GET', body } = {}) => {\n  const apiKey = readApiKey();\n  if (!apiKey) {\n    throw new Error('请先填写 API Key');\n  }\n\n  const headers = {\n    Authorization: `Bearer ${apiKey}`,\n  };\n\n  if (body) {\n    headers['Content-Type'] = 'application/json';\n  }\n\n  const response = await fetch(`${LIVEPEER_API_BASE}${path}`, {\n    method,\n    headers,\n    body: body ? JSON.stringify(body) : undefined,\n  });\n\n  const text = await response.text();\n  const parsed = safeParse(text, null);\n\n  if (!response.ok) {\n    const reason =\n      parsed?.error || parsed?.message || parsed?.details || text || `请求失败（HTTP ${response.status}）`;\n    throw new Error(String(reason));\n  }\n\n  return parsed;\n};\n\nconst toQueryString = (params) => {\n  const query = new URLSearchParams();\n  Object.entries(params).forEach(([key, value]) => {\n    if (value === undefined || value === null || value === '') return;\n    query.set(key, String(value));\n  });\n  const output = query.toString();\n  return output ? `?${output}` : '';\n};\n\nconst parseAssetPage = (payload) => {\n  if (Array.isArray(payload)) {\n    return { items: payload, nextCursor: '', hasNext: false };\n  }\n\n  const items = Array.isArray(payload?.data)\n    ? payload.data\n    : Array.isArray(payload?.assets)\n      ? payload.assets\n      : Array.isArray(payload?.items)\n        ? payload.items\n        : [];\n\n  const nextCursor =\n    payload?.nextCursor || payload?.next_cursor || payload?.meta?.nextCursor || payload?.meta?.next_cursor || '';\n\n  const hasNext = Boolean(payload?.hasNextPage || payload?.hasNext || payload?.meta?.hasNextPage || nextCursor);\n\n  return {\n    items,\n    nextCursor: String(nextCursor || ''),\n    hasNext,\n  };\n};\n\nconst listAssets = async () => {\n  const limit = 100;\n  const maxPages = 50;\n  const collected = [];\n\n  let page = 1;\n  let cursor = '';\n\n  for (let index = 0; index < maxPages; index += 1) {\n    const query = toQueryString({ limit, page, cursor });\n    const payload = await requestLivepeer(`/asset${query}`);\n    const parsed = parseAssetPage(payload);\n\n    if (!parsed.items.length) break;\n\n    collected.push(...parsed.items);\n\n    if (parsed.nextCursor) {\n      cursor = parsed.nextCursor;\n      page += 1;\n      continue;\n    }\n\n    if (parsed.items.length < limit || !parsed.hasNext) {\n      break;\n    }\n\n    page += 1;\n  }\n\n  const unique = [];\n  const seen = new Set();\n  collected.forEach((item) => {\n    const id = String(item?.id || '');\n    if (!id || seen.has(id)) return;\n    seen.add(id);\n    unique.push(item);\n  });\n\n  return unique;\n};\n\nconst toMetaPreview = (metadata) => {\n  const values = [];\n  const keys = ['unlockType', 'nftCollectionAddress', 'price', 'category'];\n  keys.forEach((key) => {\n    if (metadata?.[key] !== undefined && metadata?.[key] !== '') {\n      values.push(`${key}: ${metadata[key]}`);\n    }\n  });\n  if (values.length === 0) {\n    return '-';\n  }\n  return values.join(' | ');\n};\n\nconst setUploadProgress = (text, isError = false) => {\n  uploadProgress.textContent = text;\n  uploadProgress.style.color = isError ? '#ff9d9d' : '#97a2bb';\n};\n\nconst clearEditForm = () => {\n  editIdInput.value = '';\n  editNameInput.value = '';\n  editMetadataJsonInput.value = '';\n  editPanel.hidden = true;\n};\n\nconst buildMetadataFromUploadForm = () => {\n  const unlockType = uploadUnlockTypeInput.value === 'nft' ? 'nft' : 'free';\n  const metadata = {\n    unlockType,\n    category: uploadCategoryInput.value.trim(),\n    description: uploadDescriptionInput.value.trim(),\n    nftCollectionAddress: unlockType === 'nft' ? uploadNftAddressInput.value.trim() : '',\n    price: String(uploadPriceInput.value || '0.5').trim(),\n  };\n\n  const extras = safeParse(uploadMetadataJsonInput.value.trim() || '{}', null);\n  if (extras === null || typeof extras !== 'object' || Array.isArray(extras)) {\n    throw new Error('额外 metadata 必须是 JSON 对象');\n  }\n\n  Object.entries(extras).forEach(([key, value]) => {\n    metadata[key] = value;\n  });\n\n  return metadata;\n};\n\nconst uploadByTus = async ({ file, name, metadata }) => {\n  const apiKey = readApiKey();\n  if (!apiKey) {\n    throw new Error('请先填写 API Key');\n  }\n\n  const tusModule = await import('https://esm.sh/tus-js-client@4.3.1');\n  const tus = tusModule.default || tusModule;\n\n  const uploadMetadata = {\n    filename: file.name,\n    filetype: file.type || 'video/mp4',\n    name,\n    encrypted: uploadEncryptedInput.checked ? 'true' : 'false',\n  };\n\n  Object.entries(metadata).forEach(([key, value]) => {\n    if (value === undefined || value === null) return;\n    uploadMetadata[key] = typeof value === 'string' ? value : JSON.stringify(value);\n  });\n\n  return new Promise((resolve, reject) => {\n    const upload = new tus.Upload(file, {\n      endpoint: `${LIVEPEER_API_BASE}/asset/upload/direct`,\n      headers: {\n        Authorization: `Bearer ${apiKey}`,\n      },\n      retryDelays: [0, 1000, 3000, 5000],\n      metadata: uploadMetadata,\n      onError: (error) => {\n        reject(error instanceof Error ? error : new Error('上传失败'));\n      },\n      onProgress: (uploaded, total) => {\n        const progress = total > 0 ? ((uploaded / total) * 100).toFixed(1) : '0.0';\n        setUploadProgress(`上传中：${progress}%`);\n      },\n      onSuccess: () => {\n        resolve({ uploadUrl: upload.url || '' });\n      },\n    });\n\n    upload.start();\n  });\n};\n\nconst render = () => {\n  const query = searchInput.value.trim().toLowerCase();\n  const filtered = assets.filter((item) => {\n    if (!query) return true;\n    return item.name.toLowerCase().includes(query) || item.playbackId.toLowerCase().includes(query);\n  });\n\n  tbody.innerHTML = '';\n\n  if (filtered.length === 0) {\n    table.hidden = true;\n    emptyState.hidden = false;\n    emptyState.textContent = assets.length === 0 ? '当前没有资产，请先连接并上传。' : '没有匹配的搜索结果。';\n    return;\n  }\n\n  table.hidden = false;\n  emptyState.hidden = true;\n\n  filtered.forEach((asset) => {\n    const tr = document.createElement('tr');\n\n    const nameTd = document.createElement('td');\n    nameTd.textContent = asset.name;\n\n    const statusTd = document.createElement('td');\n    statusTd.textContent = asset.status;\n\n    const playbackTd = document.createElement('td');\n    playbackTd.textContent = asset.playbackId || '-';\n\n    const timeTd = document.createElement('td');\n    timeTd.textContent = toIsoTime(asset.createdAt);\n\n    const metadataTd = document.createElement('td');\n    metadataTd.textContent = toMetaPreview(asset.metadata);\n\n    const actionsTd = document.createElement('td');\n    actionsTd.className = 'actions-cell';\n\n    const editBtn = document.createElement('button');\n    editBtn.type = 'button';\n    editBtn.className = 'secondary';\n    editBtn.dataset.action = 'edit';\n    editBtn.dataset.id = asset.id;\n    editBtn.textContent = '编辑';\n\n    const deleteBtn = document.createElement('button');\n    deleteBtn.type = 'button';\n    deleteBtn.className = 'danger';\n    deleteBtn.dataset.action = 'delete';\n    deleteBtn.dataset.id = asset.id;\n    deleteBtn.textContent = '删除';\n\n    actionsTd.append(editBtn, deleteBtn);\n    tr.append(nameTd, statusTd, playbackTd, timeTd, metadataTd, actionsTd);\n    tbody.appendChild(tr);\n  });\n};\n\nconst refreshAssets = async (showMessage = true) => {\n  const list = await listAssets();\n  assets = list.map(normalizeAsset);\n  render();\n  if (showMessage) {\n    showToast(`已拉取 ${assets.length} 条资产`);\n  }\n  setApiStatus(`连接成功，当前资产数量：${assets.length}`);\n};\n\nconst openEdit = (id) => {\n  const target = assets.find((item) => item.id === id);\n  if (!target) {\n    showToast('未找到该资产', true);\n    return;\n  }\n\n  editIdInput.value = target.id;\n  editNameInput.value = target.name;\n  editMetadataJsonInput.value = JSON.stringify(target.metadata || {}, null, 2);\n  editPanel.hidden = false;\n  editPanel.scrollIntoView({ behavior: 'smooth', block: 'start' });\n};\n\nconst deleteAsset = async (id) => {\n  const target = assets.find((item) => item.id === id);\n  const confirmText = target ? `确认删除资源：${target.name}？` : '确认删除该资源？';\n  const confirmed = window.confirm(confirmText);\n  if (!confirmed) return;\n\n  await requestLivepeer(`/asset/${encodeURIComponent(id)}`, { method: 'DELETE' });\n  assets = assets.filter((item) => item.id !== id);\n  render();\n  clearEditForm();\n  showToast('已删除资源');\n};\n\nsaveKeyBtn.addEventListener('click', () => {\n  const key = readApiKey();\n  if (!key) {\n    showToast('请先输入 API Key', true);\n    return;\n  }\n  localStorage.setItem(API_KEY_STORAGE, key);\n  showToast('API Key 已保存到浏览器本地');\n});\n\nclearKeyBtn.addEventListener('click', () => {\n  localStorage.removeItem(API_KEY_STORAGE);\n  apiKeyInput.value = '';\n  assets = [];\n  render();\n  clearEditForm();\n  setApiStatus('API Key 已清除。');\n  showToast('已清除 API Key');\n});\n\nconnectBtn.addEventListener('click', async () => {\n  try {\n    setApiStatus('连接中...');\n    await refreshAssets();\n  } catch (error) {\n    setApiStatus('连接失败，请检查 API Key 或网络。', true);\n    showToast(error instanceof Error ? error.message : '连接失败', true);\n  }\n});\n\nrefreshBtn.addEventListener('click', async () => {\n  try {\n    await refreshAssets();\n  } catch (error) {\n    showToast(error instanceof Error ? error.message : '刷新失败', true);\n  }\n});\n\nsearchInput.addEventListener('input', () => {\n  render();\n});\n\nuploadForm.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  const file = uploadFileInput.files?.[0];\n\n  if (!file) {\n    showToast('请选择视频文件', true);\n    return;\n  }\n\n  const name = uploadNameInput.value.trim();\n  if (!name) {\n    showToast('请输入资源名称', true);\n    return;\n  }\n\n  try {\n    const metadata = buildMetadataFromUploadForm();\n    setUploadProgress('初始化上传...');\n    await uploadByTus({ file, name, metadata });\n    setUploadProgress('上传完成，正在等待 Livepeer 处理...');\n    showToast('上传成功，请稍等后刷新列表');\n\n    uploadForm.reset();\n    uploadPriceInput.value = '0.5';\n\n    window.setTimeout(async () => {\n      try {\n        await refreshAssets(false);\n        setUploadProgress('已刷新列表。');\n      } catch {\n        setUploadProgress('上传成功，自动刷新失败，请手动点击“刷新列表”。', true);\n      }\n    }, 1800);\n  } catch (error) {\n    setUploadProgress('上传失败。', true);\n    showToast(error instanceof Error ? error.message : '上传失败', true);\n  }\n});\n\nuploadResetBtn.addEventListener('click', () => {\n  uploadForm.reset();\n  uploadPriceInput.value = '0.5';\n  setUploadProgress('已清空上传表单。');\n});\n\ntbody.addEventListener('click', async (event) => {\n  const target = event.target;\n  if (!(target instanceof HTMLElement)) return;\n\n  const { action, id } = target.dataset;\n  if (!action || !id) return;\n\n  try {\n    if (action === 'edit') {\n      openEdit(id);\n      return;\n    }\n\n    if (action === 'delete') {\n      await deleteAsset(id);\n    }\n  } catch (error) {\n    showToast(error instanceof Error ? error.message : '操作失败', true);\n  }\n});\n\neditCancelBtn.addEventListener('click', () => {\n  clearEditForm();\n});\n\neditForm.addEventListener('submit', async (event) => {\n  event.preventDefault();\n\n  const id = editIdInput.value.trim();\n  if (!id) {\n    showToast('缺少 asset id', true);\n    return;\n  }\n\n  const name = editNameInput.value.trim();\n  if (!name) {\n    showToast('资源名称不能为空', true);\n    return;\n  }\n\n  const metadata = safeParse(editMetadataJsonInput.value.trim() || '{}', null);\n  if (metadata === null || typeof metadata !== 'object' || Array.isArray(metadata)) {\n    showToast('metadata 必须是 JSON 对象', true);\n    return;\n  }\n\n  try {\n    await requestLivepeer(`/asset/${encodeURIComponent(id)}`, {\n      method: 'PATCH',\n      body: {\n        name,\n        metadata,\n      },\n    });\n\n    showToast('已保存修改');\n    clearEditForm();\n    await refreshAssets(false);\n  } catch (error) {\n    showToast(error instanceof Error ? error.message : '保存失败', true);\n  }\n});\n\nconst bootstrap = async () => {\n  const cachedKey = localStorage.getItem(API_KEY_STORAGE) || '';\n  apiKeyInput.value = cachedKey;\n  uploadPriceInput.value = '0.5';\n\n  if (!cachedKey) {\n    setApiStatus('尚未连接。');\n    render();\n    return;\n  }\n\n  setApiStatus('检测到本地 API Key，尝试自动连接...');\n  try {\n    await refreshAssets(false);\n    showToast('已自动连接 Livepeer');\n  } catch {\n    setApiStatus('自动连接失败，请检查 API Key。', true);\n  }\n};\n\nbootstrap();\n"],"file":"assets/admin-pJzN7nLi.js"}