<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CineNext 视频上传</title>
    <link rel="stylesheet" href="/admin.css" />
  </head>
  <body>
    <main class="page">
      <header class="header">
        <h1>上传视频</h1>
        <p>两步骤上传：先新建剧信息，再按集数顺序逐集上传视频。</p>
      </header>

      <section class="panel">
        <h2>API 连接</h2>
        <div class="inline-row">
          <label class="inline-input">
            Livepeer API Key
            <input id="api-key" type="password" placeholder="请输入 Livepeer API Key" autocomplete="off" />
          </label>
          <div class="actions-row">
            <button type="button" id="save-key" class="secondary">保存到本地</button>
            <button type="button" id="clear-key" class="danger">清除 Key</button>
            <a href="admin.html" class="link-btn secondary">返回资产列表</a>
          </div>
        </div>
        <p id="api-status" class="tip">尚未连接。</p>
      </section>

      <section class="panel">
        <h2>步骤 1：新建剧</h2>
        <form id="series-form" class="form-grid">
          <label>
            剧名
            <input id="series-name" required placeholder="例如：总裁的替身新娘" />
          </label>

          <label>
            总集数
            <input id="series-total-episodes" type="number" min="1" step="1" required value="1" />
          </label>

          <label>
            前 X 集免费
            <input id="series-free-episodes" type="number" min="0" step="1" value="0" />
          </label>

          <label>
            每集价格 TON
            <input id="series-price-per-episode" type="number" min="0" step="0.1" value="0.5" />
          </label>

          <label>
            简介（可选）
            <input id="series-description" placeholder="例如：豪门甜宠短剧" />
          </label>

          <label>
            演员（可选，逗号分隔）
            <input id="series-actors" placeholder="演员A, 演员B" />
          </label>

          <div class="actions">
            <button type="submit" id="series-submit">保存剧信息</button>
            <button type="button" id="series-reset" class="secondary">清空</button>
          </div>
        </form>
        <p id="series-status" class="tip">还未创建剧信息。</p>
      </section>

      <section class="panel">
        <h2>步骤 2：按顺序上传视频</h2>
        <form id="upload-form" class="form-grid">
          <label>
            选择剧
            <select id="upload-series-select" required>
              <option value="">请先在步骤 1 新建剧</option>
            </select>
          </label>

          <label>
            当前应上传集数
            <input id="episode-number" type="number" min="1" step="1" required value="1" readonly />
          </label>

          <label>
            资源名称前缀（可选）
            <input id="upload-name" placeholder="不填则自动生成：剧名 第X集；批量时作为前缀" />
          </label>

          <label>
            视频文件（支持多选）
            <input id="upload-file" type="file" accept="video/*" required multiple />
          </label>

          <div class="actions">
            <button type="submit" id="upload-submit">开始上传</button>
            <button type="button" id="upload-reset" class="secondary">清空上传表单</button>
          </div>
        </form>

        <div class="queue-box">
          <p id="queue-summary" class="tip">当前未选择文件。</p>
          <p class="tip">可在下方预览中点击“上移/下移”调整上传顺序，顺序将对应集数。</p>
          <ul id="queue-list" class="queue-list"></ul>
        </div>

        <p id="upload-progress" class="tip">等待上传。</p>
      </section>

      <p id="toast" class="toast" aria-live="polite"></p>
    </main>

    <script type="module" src="/upload.js"></script>
  </body>
</html>
